{
  "schemas": [
    {
      "id": "req-id-pattern",
      "severity": "info",
      "message": "Requirement IDs should follow consistent patterns",
      "select": {
        "properties": {
          "type": { "const": "req" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^(R_|SWREQ_|REQ_|EX_REQ_)[A-Za-z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "spec-id-pattern",
      "severity": "info",
      "message": "Specification IDs should follow consistent patterns",
      "select": {
        "properties": {
          "type": { "const": "spec" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^(S_|SPEC_|EX_SPEC_)[A-Za-z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "impl-id-pattern",
      "severity": "info",
      "message": "Implementation IDs should follow consistent patterns",
      "select": {
        "properties": {
          "type": { "const": "impl" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^(I_|IMPL_|GH_PR_)[A-Za-z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "test-id-pattern",
      "severity": "info",
      "message": "Test IDs should follow consistent patterns",
      "select": {
        "properties": {
          "type": { "const": "test" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^(T_|TEST_|EX_TEST_)[A-Za-z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "person-id-pattern",
      "severity": "info",
      "message": "Person IDs should ideally follow the pattern P_* but names are also acceptable",
      "select": {
        "properties": {
          "type": { "const": "person" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^(P_[A-Z0-9_]+|[A-Z]+)$"
            }
          }
        }
      }
    },
    {
      "id": "swarch-id-pattern",
      "severity": "warning",
      "message": "SW Architecture IDs should follow the pattern SWARCH_*",
      "select": {
        "properties": {
          "type": { "const": "swarch" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^SWARCH_[A-Z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "swreq-id-pattern",
      "severity": "info",
      "message": "SW Requirement IDs should follow consistent patterns",
      "select": {
        "properties": {
          "type": { "const": "swreq" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^(SWREQ_|GH_ISSUE_)[A-Z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "automotive-req-status-required",
      "severity": "warning",
      "message": "Requirements in automotive-adas must have a valid status set",
      "select": {
        "allOf": [
          {
            "properties": {
              "type": { "const": "req" }
            }
          },
          {
            "properties": {
              "docname": {
                "type": "string",
                "pattern": ".*automotive-adas.*"
              }
            },
            "required": ["docname"]
          }
        ]
      },
      "validate": {
        "local": {
          "properties": {
            "status": {
              "enum": ["open", "in progress", "closed", "passed", "failed"]
            }
          },
          "required": ["status"]
        }
      }
    },
    {
      "id": "automotive-req-release-required",
      "severity": "warning",
      "message": "Requirements in automotive-adas must be linked to a release",
      "select": {
        "allOf": [
          {
            "properties": {
              "type": { "const": "req" }
            }
          },
          {
            "properties": {
              "docname": {
                "type": "string",
                "pattern": ".*automotive-adas.*"
              }
            },
            "required": ["docname"]
          }
        ]
      },
      "validate": {
        "local": {
          "properties": {
            "release": {
              "type": "array",
              "minItems": 1
            }
          },
          "required": ["release"]
        }
      }
    },
    {
      "id": "spec-links-to-req",
      "severity": "info",
      "message": "Specifications should link to requirements using 'reqs' link type",
      "select": {
        "properties": {
          "type": { "const": "spec" }
        }
      },
      "validate": {
        "network": {
          "reqs": {
            "items": {
              "local": {
                "properties": {
                  "type": { "const": "req" }
                }
              }
            }
          }
        }
      }
    },
    {
      "id": "impl-links-to-spec",
      "severity": "info",
      "message": "Implementations should link to specifications using 'implements' link type",
      "select": {
        "properties": {
          "type": { "const": "impl" }
        }
      },
      "validate": {
        "network": {
          "implements": {
            "items": {
              "local": {
                "properties": {
                  "type": { "const": "spec" }
                }
              }
            }
          }
        }
      }
    },
    {
      "id": "test-has-spec-or-impl",
      "severity": "info",
      "message": "Test cases should link to either specs or implementations",
      "select": {
        "properties": {
          "type": { "const": "test" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "spec": {},
            "specs": {},
            "links": {}
          }
        }
      }
    },
    {
      "id": "person-has-role",
      "severity": "info",
      "message": "Person needs should have a role defined",
      "select": {
        "properties": {
          "type": { "const": "person" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "role": {
              "type": "string",
              "minLength": 1
            }
          },
          "required": ["role"]
        }
      }
    },
    {
      "id": "team-has-persons",
      "severity": "info",
      "message": "Team needs should have persons assigned",
      "select": {
        "properties": {
          "type": { "const": "team" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "persons": {
              "type": "array",
              "minItems": 1
            }
          },
          "required": ["persons"]
        }
      }
    },
    {
      "id": "hazard-id-pattern",
      "severity": "warning",
      "message": "Hazard IDs should follow the pattern HAZ_*",
      "select": {
        "properties": {
          "type": { "const": "hazard" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^HAZ_[A-Z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "safety-goal-id-pattern",
      "severity": "warning",
      "message": "Safety Goal IDs should follow the pattern SG_*",
      "select": {
        "properties": {
          "type": { "const": "safety_goal" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^SG_[A-Z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "fsr-id-pattern",
      "severity": "warning",
      "message": "FSR IDs should follow the pattern FSR_*",
      "select": {
        "properties": {
          "type": { "const": "fsr" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^FSR_[A-Z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "hazard-asil-required",
      "severity": "warning",
      "message": "Hazards in safety_example must have a valid ASIL rating",
      "select": {
        "allOf": [
          {
            "properties": {
              "type": { "const": "hazard" }
            }
          },
          {
            "properties": {
              "docname": {
                "type": "string",
                "pattern": ".*safety_example.*"
              }
            },
            "required": ["docname"]
          }
        ]
      },
      "validate": {
        "local": {
          "properties": {
            "asil": {
              "enum": ["QM", "A", "B", "C", "D"]
            }
          },
          "required": ["asil"]
        }
      }
    },
    {
      "id": "safety-goal-asil-required",
      "severity": "warning",
      "message": "Safety Goals must have ASIL and mitigate at least one hazard",
      "select": {
        "allOf": [
          {
            "properties": {
              "type": { "const": "safety_goal" }
            }
          },
          {
            "properties": {
              "docname": {
                "type": "string",
                "pattern": ".*safety_example.*"
              }
            },
            "required": ["docname"]
          }
        ]
      },
      "validate": {
        "local": {
          "properties": {
            "asil": {
              "enum": ["QM", "A", "B", "C", "D"]
            },
            "mitigates": {
              "type": "array",
              "minItems": 1
            }
          },
          "required": ["asil", "mitigates"]
        },
        "network": {
          "mitigates": {
            "items": {
              "local": {
                "properties": {
                  "type": { "const": "hazard" }
                }
              }
            }
          }
        }
      }
    },
    {
      "id": "fsr-derives-from-safety-goal",
      "severity": "warning",
      "message": "FSRs should derive from at least one Safety Goal",
      "select": {
        "allOf": [
          {
            "properties": {
              "type": { "const": "fsr" }
            }
          },
          {
            "properties": {
              "docname": {
                "type": "string",
                "pattern": ".*safety_example.*"
              }
            },
            "required": ["docname"]
          }
        ]
      },
      "validate": {
        "local": {
          "required": ["derives_from", "asil"],
          "properties": {
            "derives_from": {
              "type": "array",
              "minItems": 1
            }
          }
        },
        "network": {
          "derives_from": {
            "items": {
              "local": {
                "properties": {
                  "type": { "const": "safety_goal" }
                }
              }
            }
          }
        }
      }
    },
    {
      "id": "sysreq-id-pattern",
      "severity": "warning",
      "message": "System Requirement IDs should follow the pattern SYSREQ_*",
      "select": {
        "properties": {
          "type": { "const": "sysreq" }
        }
      },
      "validate": {
        "local": {
          "properties": {
            "id": {
              "pattern": "^SYSREQ_[A-Z0-9_]+$"
            }
          }
        }
      }
    },
    {
      "id": "sysreq-implements-fsr",
      "severity": "warning",
      "message": "System Requirements should implement at least one FSR",
      "select": {
        "allOf": [
          {
            "properties": {
              "type": { "const": "sysreq" }
            }
          },
          {
            "properties": {
              "docname": {
                "type": "string",
                "pattern": ".*safety_example.*"
              }
            },
            "required": ["docname"]
          }
        ]
      },
      "validate": {
        "local": {
          "required": ["implements", "asil"],
          "properties": {
            "implements": {
              "type": "array",
              "minItems": 1
            }
          }
        },
        "network": {
          "implements": {
            "items": {
              "local": {
                "properties": {
                  "type": { "const": "fsr" }
                }
              }
            }
          }
        }
      }
    }
  ]
}
